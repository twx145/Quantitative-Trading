<?xml version="1.0" encoding="UTF-8"?>

<!-- 根布局 -->
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>
<BorderPane fx:id="rootPane" styleClass="body" stylesheets="@style.css" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.twx.platform.ui.UIController">
    <!-- 【新增】顶部标准菜单栏 -->
    <top>
        <MenuBar fx:id="menuBar" />
    </top>

    <!-- 左侧工具栏 (保持不变) -->
    <left>
        <VBox fx:id="leftToolBar" alignment="TOP_CENTER" styleClass="side-button-bar">
            <ToggleButton fx:id="aiAssistantToggle" styleClass="side-tool-button">
                <graphic><SVGPath content="M 6 3 L 6 4 C 6 4.55 6.45 5 7 5 L 13 5 C 13.55 5 14 4.55 14 4 L 14 3 L 6 3 Z M 5 6 L 5 14 C 5 14.55 5.45 15 6 15 L 14 15 C 14.55 15 15 14.55 15 14 L 15 6 L 5 6 Z M 8 8.5 C 8 7.67 8.67 7 9.5 7 S 11 7.67 11 8.5 10.33 10 9.5 10 8 9.33 8 8.5 Z M 12.5 13 C 11.84 13 11.23 12.82 10.74 12.5 C 10.24 12.18 9.87 11.72 9.68 11.18 C 9.5 10.64 9.5 10.06 9.68 9.5 C 9.87 8.94 10.24 8.45 10.74 8.11 C 10.96 8.28 11.22 8.5 11.5 8.74 C 11.78 8.98 12.04 9.22 12.26 9.44 C 12.39 9.56 12.5 9.7 12.58 9.82 C 12.92 10.29 13.01 10.88 12.83 11.42 C 12.65 11.96 12.23 12.4 11.7 12.66 C 11.92 12.78 12.21 12.89 12.5 12.94 V 13 Z M 7.5 13 C 7.5 13 8.16 13 8.74 12.5 C 8.93 12.35 9.09 12.18 9.24 12 C 8.61 11.94 8.06 11.66 7.67 11.18 C 7.29 10.71 7.15 10.12 7.29 9.56 C 7.44 9 7.82 8.53 8.32 8.21 C 8.04 8.02 7.77 7.82 7.5 7.61 C 6.95 7.97 6.54 8.47 6.32 9.06 C 6.11 9.66 6.11 10.34 6.32 10.94 C 6.54 11.53 6.95 12.03 7.5 12.39 V 13 Z" styleClass="svg-icon" /></graphic>
            </ToggleButton>
        </VBox>
    </left>
    <!-- 右侧工具栏 (保持不变) -->
    <!-- 在你的主 FXML 的 <right> 部分, 用下面的代码完全替换 -->
    <right>
        <VBox fx:id="rightToolBar" alignment="TOP_CENTER" styleClass="side-button-bar">

            <ToggleButton fx:id="chartSettingsToggle" styleClass="side-tool-button">
                <graphic>
                    <SVGPath content="M4 18 L8 14 L12 16 L16 12 L20 14 M6 20 V18 M10 20 V19 M14 20 V17 M18 20 V18" styleClass="svg-icon" />
                </graphic>
            </ToggleButton>

            <ToggleButton fx:id="strategySettingsToggle" styleClass="side-tool-button">
                <graphic>
                    <SVGPath content="M9 2 H15 V6 H9 Z M12 6 V10 M12 10 H5 V14 H2 V18 H8 V14 H5 M12 10 H19 V14 H16 V18 H22 V14 H19" styleClass="svg-icon" />
                </graphic>
            </ToggleButton>

        </VBox>
    </right>
    <!-- 底部状态栏 (保持不变) -->
    <bottom>
        <HBox alignment="CENTER_LEFT" styleClass="bottom-status-bar">
            <ToggleButton fx:id="resultsToggle" styleClass="status-bar-button">
                <graphic><SVGPath content="M4 4H20V6H4V4ZM4 10H14V12H4V10ZM4 16H20V18H4V16Z" styleClass="svg-icon" /></graphic>
            </ToggleButton>
        </HBox>
    </bottom>
    <!-- 在你的 FXML 文件中，找到 <center> 标签 -->
    <center>
        <BorderPane>
            <top>
                <VBox spacing="10.0">
                    <padding><Insets bottom="10.0" left="10.0" right="10.0" top="10.0" /></padding>

                    <!-- 【修改】用下面这个 GridPane 替换你原来的 -->
                    <GridPane hgap="10.0" vgap="10.0">
                        <columnConstraints>
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" prefWidth="200.0" />
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="10.0" prefWidth="200.0" />
                            <!-- 【新增】为“复位视图”按钮增加一列 -->
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" />
                            <!-- 为“运行回测”按钮保留的列 -->
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" />
                        </columnConstraints>

                        <!-- Row 0 -->
                        <Label text="股票代码:" />
                        <TextField fx:id="tickerField" text="sh600519" GridPane.columnIndex="1" />
                        <Label text="初始资金:" GridPane.columnIndex="2" />
                        <TextField fx:id="initialCashField" text="100000.0" GridPane.columnIndex="3" />

                        <!-- Row 1 -->
                        <Label text="开始日期:" GridPane.rowIndex="1" />
                        <DatePicker fx:id="startDatePicker" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        <Label text="结束日期:" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                        <DatePicker fx:id="endDatePicker" maxWidth="Infinity" GridPane.columnIndex="3" GridPane.rowIndex="1" />

                        <!-- Row 2 -->
                        <Label text="仓位策略:" GridPane.rowIndex="2" />
                        <ComboBox fx:id="positionSizerComboBox" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                        <Label fx:id="sizerParamLabel" text="参数:" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                        <TextField fx:id="sizerParamField" GridPane.columnIndex="3" GridPane.rowIndex="2" />

                        <!-- 【新增】复位视图按钮 -->
                        <Button fx:id="resetViewButton" onAction="#handleResetChartView" text="复位视图" maxWidth="Infinity" GridPane.columnIndex="4" GridPane.rowIndex="2" />

                        <!-- 【位置调整】将“运行回测”按钮移动到最后一列 -->
                        <Button fx:id="runButton" maxWidth="Infinity" onAction="#handleRunBacktest" text="运行回测" GridPane.columnIndex="5" GridPane.rowIndex="2" />

                    </GridPane>
                </VBox>
            </top>
            <center>
                <BorderPane fx:id="chartPane" />
            </center>
        </BorderPane>
    </center>
</BorderPane>